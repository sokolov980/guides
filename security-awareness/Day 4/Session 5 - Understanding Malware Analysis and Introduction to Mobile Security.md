# Malware Analysis

## Recent Trends in Cyber Crimes
- **Contact Methods:**
  - Normal Website
  - Compromised Website
  - Spammed Link
- **Redirect Techniques:**
  - Malicious Advertisement
  - Traffic Direction System
- **Exploitation:**
  - Exploit Server Kit
- **Infection Types:**
  - Ransomware
  - Banking Trojan
  - Malware

### Typical Attack Flow
- Normal Website → Malicious Advertisement → Traffic Direction System
- Compromised Website → Traffic Direction System
- Spammed Link → Traffic Direction System
- Traffic Direction System → Exploit Server Kit → Ransomware / Banking Trojan / Malware

## What is Malware?
- Malicious software designed to damage or disable computer systems.
- Provides limited or full control of the system to the attacker.
- Created to steal information, disrupt services, or gain unauthorized access.
- Can be code, scripts, executables, libraries, or other application types.

## Malware Classification

### By Means of Distribution
- Self-spreading (e.g., worms, viruses)
- Non-spreading (e.g., trojans, spyware)

### By Dependency on Host
- Requires a host (e.g., virus, rootkit, trojans)
- Runs independently (e.g., worms, spyware)

### Common Malware Types

| Type       | Characteristics                                                                                     |
|------------|--------------------------------------------------------------------------------------------------|
| **Virus**  | Self-replicates by inserting copies into host files or programs; requires user interaction.       |
| **Worm**   | Self-replicating, self-contained program; usually runs without user interaction.                   |
| **Trojan** | Non-replicating, appears benign but hides malicious intent; often delivered by social engineering.|
| **Spyware**| Collects personal info, browsing habits, and sends it to third parties.                           |
| **Adware** | Tracks internet browsing to deliver targeted advertisements.                                      |
| **Browser Hijacker** | Alters browsing settings, redirects users to unwanted sites, changes home/search pages.    |

### Virus Subtypes
- **Compiled Viruses:** Executed by the OS.
- **Interpreted Viruses:** Executed by an application.

### Worm Categories
- **Network Service Worms:** Exploit network service vulnerabilities to spread.
- **Mass Mailing Worms:** Self-contained worms that spread via email.

## How Malware Enters a System
- Instant Messenger applications.
- Removable storage devices.
- Email attachments.
- File sharing.
- Fake or fraudulent software.
- Untrusted websites and downloads.

## Malware Distribution on the Web
- Black-hat SEO to rank malware sites high in search results.
- Malvertising embedded in legitimate ad networks.
- Compromised legitimate websites hosting malware.
- Social engineered click-jacking tricks users into clicking malicious links.
- Spear-phishing sites mimicking real sites to steal credentials.
- Drive-by downloads exploiting browser vulnerabilities.

## How Hackers Use Trojans
- Delete or replace critical OS files.
- Generate fake traffic to cause Denial of Service (DoS) attacks.
- Record screenshots, audio, and video covertly.
- Use infected PCs for spamming and email blasts.
- Download additional spyware, adware, and malware.
- Disable firewalls and antivirus programs.
- Create backdoors for remote access.
- Turn victims into proxies or bots for relaying attacks.
- Steal credentials via keyloggers.

## Common Ports Used by Trojans
(Typical Trojan ports with examples)

- 20: Senna Spy  
- 21: Blade Runner, Doly Trojan, Invisible FTP, WebEx, WinCrash  
- 22: Shaft  
- 23: Tiny Telnet Server  
- 25: Antigen, Email Password Sender, Terminator, WinPC, WinSpy  
- 421: TCP Wrappers Trojan  
- 555: Ini-Killer, Phase, Zero, Stealth Spy  
- 666: Satanz Backdoor  
- 1234: Ultors Trojan  
- 1243: SubSeven 1.0 - 1.8  
- 31337-38: Back Orifice, DeepBo  
- 5000: Bubbel  
- 65000: Devil  
- ... *(and many others as listed)*

## How to Infect Systems Using Trojans
- Create a Trojan packet.
- Create a dropper that installs malicious code as part of the Trojanized package.
- Use wrapper tools to bind Trojan executables with legitimate applications.
- Propagate the Trojan by social engineering or distribution methods.

## Wrappers
- Combine Trojan executable with legitimate .exe files.
- When run, Trojan installs silently while legitimate app executes normally.

## Virus-Attack Indications
- Increased resource usage and slower performance.
- Unexplained beeping with no display.
- Operating system fails to load.
- Frequent freezing and crashes.
- Missing files and folders.
- Browser windows freeze.

## Nature of Today's Malware

### Customized Malware
1. Toolkit sends spam to lure users to malicious websites.
2. Websites host malicious content provided by the toolkit.
3. Exploits OS vulnerabilities to infect users’ computers with Trojans.

### Stealthy Malware (APTs)
- Designed for quiet, slow spreading and prolonged data gathering.
- Advanced Persistent Threats (APTs) can conduct months or years of surveillance.
- Hard to detect and remove; may require full OS reinstall and data restoration.

## Recent Malware Attacks

### In India
- Over 1.15 million cyber incidents reported to CERT-In in 2021.
- Ransomware attacks increased by 120%.
- Targets included power companies, telecom, restaurants, and healthcare.
- Example: Mumbai power outage in 2020 caused by cyber attack affecting critical infrastructure.

### Notable Malware Examples
- **Pegasus:** Israeli spyware capable of deep surveillance on mobile devices.
- **ShadowPad:** Backdoor Trojan targeting power plants in Maharashtra (2020).
- **REvil:** Ransomware that exfiltrates data and posts it online if ransom unpaid.
- **PoS Malware:** Targets payment terminals to steal card data.
- **Stuxnet:** Targets industrial control systems via USB/web links.
- **Lazarus Group:** APT targeting pharmaceutical companies.

## Malware Analysis Techniques

### Static Analysis
- Examining malware code without executing it.
  
### Dynamic Analysis
- Running malware in a controlled environment to observe behavior.

### Useful Tools
- **TCPView:** Monitors processes and network connections.  
- **Procmon:** Detailed system monitoring tool ([Download here](https://docs.microsoft.com/en-us/sysinternals/downloads/procmon))  
- **VirusTotal:** Online malware scanning and analysis ([Upload files here](https://www.virustotal.com/gui/home/upload))  

## Malware Countermeasures
- Avoid opening suspicious file attachments or downloading apps from unknown sources.
- Block unnecessary ports on hosts and firewalls.
- Avoid transferring files during chats or untrusted communications.
- Keep OS and software patched and updated.
- Use antivirus and scan devices regularly.
- Stay informed about emerging threats.
- Avoid files with multiple file extensions (e.g., `.txt.exe`).

[[Session 6 - Understanding Android App Security]]